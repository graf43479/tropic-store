@model Domain.Entities.NewsTape


@{ AjaxOptions ajax = new AjaxOptions
   {
       UpdateTargetId = "newsDetails",
       //Url = Url.Action("ChangeQuantity"),
       Url = Url.Action("CreateNews"),
       /*HttpMethod = "Post",*/
       InsertionMode = InsertionMode.Replace,
       HttpMethod = "POST",
       OnBegin = "gifLoaderBefore",
       OnSuccess = "gifLoaderAfter",
       OnFailure = "gifLoaderAfter",
       OnComplete = "gifLoaderAfter"

   }; 
}

<style>
    form {
        background-color: #FFFFFF;
        border: none;
        margin: 0;
    }
</style>
@*<div id="newsList">
    <h2>Все новости</h2>
    @Html.Action("NewsList","Admin")
</div>*@

<div id="newsDetails" class="col-lg-12 col-md-12">
    <h2>Публикация новости</h2>
    <div class="row">
        <div class="col-lg-12 col-md-12">
    @using (Ajax.BeginForm(ajax))
    {
        <p>@Html.ValidationSummary(true)</p>
        @Html.HiddenFor(x => x.NewsID)
        
        <div class="col-lg-12 col-md-12" style="padding: 0;">
        <div class="form-group" style="padding: 0; margin-bottom: 12px">
            <label class="col-lg-3 col-md-3 form-control-static">Главный заголовок</label>
            <div class="col-lg-9 col-md-9" style="padding: 0 0 4px 0;">@Html.EditorFor(x => x.Header1) @Html.ValidationMessageFor(x => x.Header1)</div>
        </div></div>
        
        <div class="form-group" style="">
            <label class="col-lg-3 col-md-3 form-control-static">Подзаголовок</label>
            <div class="col-lg-9 col-md-9" style="padding: 0 0 4px 0;">@Html.EditorFor(x => x.Header2) @Html.ValidationMessageFor(x => x.Header2)</div>
        </div>
        
        <div class="form-group">
            <label class="col-lg-3 col-md-3 form-control-static">Путь к изображению</label>
            <div class="col-lg-9 col-md-9" style="padding: 0 0 4px 0;">@Html.EditorFor(x => x.ImgPath) @Html.ValidationMessageFor(x => x.ImgPath)</div>
        </div>
        
        <div class="form-group">
            <label class="col-lg-3 col-md-3 form-control-static">Дата новости</label>
            <div class="col-lg-3 col-md-3" style="padding: 0 0 4px 0;">@Html.EditorFor(x => x.NewsDate) @Html.ValidationMessageFor(x => x.NewsDate)</div>
            <label class="col-lg-3 col-md-3 form-control-static" style="text-align: right; padding-right: 5px;">Дата изменения</label>
            <div class="col-lg-3 col-md-3" style="padding: 0 0 4px 0;">@Html.TextBoxFor(x => x.UpdateDate, new { @readonly = "readonly", @class = "form-control" })</div>
        </div>
 
        <div class="form-group">
            <label class="col-lg-3 col-md-3 form-control-static">Анонс</label>
            <div class="col-lg-9 col-md-9" style="padding: 0 0 4px 0;">@Html.TextAreaFor(x => x.NewsPreview) @Html.ValidationMessageFor(x => x.NewsPreview)</div>
        </div>
         
        <div class="form-group">
            <label class="col-lg-3 col-md-3 form-control-static">Текст</label>
            <div class="col-lg-9 col-md-9" style="padding: 0;">@Html.TextAreaFor(x => x.NewsText) @Html.ValidationMessageFor(x => x.NewsText)</div>
        </div>
             @*   <p>Главный заголовок: @Html.EditorFor(x => x.Header1) @Html.ValidationMessageFor(x => x.Header1)</p>
        <p>Подзаголовок: @Html.EditorFor(x => x.Header2) @Html.ValidationMessageFor(x => x.Header2)</p>
        <p>Путь к изображению: @Html.EditorFor(x => x.ImgPath) @Html.ValidationMessageFor(x => x.ImgPath)</p>
        <p>Дата новости: @Html.EditorFor(x => x.NewsDate) @Html.ValidationMessageFor(x => x.NewsDate)</p>        
        <p>Анонс: @Html.TextAreaFor(x => x.NewsPreview) @Html.ValidationMessageFor(x => x.NewsPreview)</p>
        <p>Текст: @Html.TextAreaFor(x => x.NewsText) @Html.ValidationMessageFor(x => x.NewsText)</p>
    *@
     @*<input class="button" value="Готово" type="submit" style="height: 27;"/>*@
         <div class="form-group">
            <label class="col-lg-9 col-md-9">&nbsp;</label>
            <input class="btn btn-info col-lg-3 col-md-3" value="Готово" type="submit" style="margin: 10px 0;" />
         </div>
     @*   <input type="submit" class="actionButtons" value="Готово"/>*@
    
    }
    </div>
    </div>

    @using (Html.BeginForm("DeleteNews", "Admin"))
    {
        @Html.HiddenFor(x => x.NewsID)
         <div class="form-group" style="margin:0;">
        <label class="col-lg-9 col-md-9">&nbsp;</label>
            <input class="btn btn-danger col-lg-3 col-md-3" value="Удалить" type="submit" style="margin: 0 0 10px 0;"/>
         </div>}
</div>

@*
<div>
<textarea id="NewsText" name="NewsText"></textarea>
</div>
*@
<link href="@Url.Content("~/Content/jquery.cleditor.css")" rel="stylesheet" type="text/css" />
@*<script src="@Url.Content("~/Scripts/jquery.cleditor.js")" type="text/javascript"></script>*@
<script src="@Url.Content("~/Scripts/jquery.cleditor.min.js")" type="text/javascript"></script>
<script type="text/javascript">
    $("#NewsText").cleditor();
    $("#NewsPreview").cleditor();
</script>




@*<div class="col-lg-12 col-md-12">
        <div class="form-group" style="padding: 0">
            <div class="col-lg-4 col-md-4" style="padding: 0"> @{
                                                                   string filename = string.Empty;
       if ((string.IsNullOrWhiteSpace(Model.ImageExt)) || (System.IO.File.Exists(System.IO.Path.Combine(Server.MapPath
                               (@Url.Content("~/Content")), Domain.Constants.CATEGORY_MINI_IMAGES_FOLDER, @Model.CategoryID.ToString() + @Model.ImageExt)) != true))
       { filename = "0.jpg"; }
       else { filename = string.Format("{0}{1}?{2}", Model.CategoryID, Model.ImageExt.TrimEnd(), DateTime.Now); }
                    }
                    <img class="example-image-link" src='@(Url.Content("~/Content"))/@(Domain.Constants.CATEGORY_MINI_IMAGES_FOLDER)/@(filename)' alt='@Model.Name' /> 
            
            </div>    
    
            <div class="col-lg-4 col-md-4" style="padding: 0"> <input type="file" name="imagefile" class = "form-control"/></div>    
            <div class="col-lg-4 col-md-4" style="padding: 0"> <input type="submit" class = "form-control btn-info" value="Загрузить"/></div>  
        *@

<div id="uploadNewsImage" class="col-lg-12 col-md-12" style="display: none">

    <h2>Изображение для текущей новости </h2>
    
    
    @if (Model == null)
    {
    }
    else
    {
        using (Html.BeginForm("UploadNewsImage", "Admin", FormMethod.Post, new { enctype = "multipart/form-data" }))
        {

             @Html.Hidden("newsId", Model.NewsID)

            <div class="form-group" style="padding: 0">
                <div class="col-lg-4 col-md-4">
                    @{
                        string filename = string.Empty;

                        if ((string.IsNullOrWhiteSpace(Model.ImgPath)) || (System.IO.File.Exists(System.IO.Path.Combine(Server.MapPath
                                                                                                                            (@Url.Content("~/Content")), Domain.Constants.NEWS_MINI_IMAGES_FOLDER, @Model.NewsID.ToString() + @Model.ImgPath)) != true))
                        {
                            filename = "0.jpg";
                        }
                        else
                        {
                            filename = string.Format("{0}{1}?{2}", Model.NewsID, Model.ImgPath.TrimEnd(), DateTime.Now);
                        }
                    }
                    <img class="example-image-link" src='@(Url.Content("~/Content"))/@(Domain.Constants.NEWS_MINI_IMAGES_FOLDER)/@(filename)' alt='@Model.NewsDate' /> 
                </div>
                
            <div class="col-lg-5 col-md-5" style="padding: 0"> <input type="file" name="imagefile" class = "form-control"/></div>    
            <div class="col-lg-3 col-md-3" style="padding: 0"> <input type="submit" class = "form-control btn-info" value="Загрузить"/></div>  

            </div>
        }
    }
   </div>
    <br/>
   
   
   @{
       if (Model != null)
       {
           if (Model.NewsID != 0)
           {
            <script>                document.getElementById("uploadNewsImage").style.display = "inherit"</script>
           }
           else
           {
            <script>                document.getElementById("uploadNewsImage").display = "none"</script>
            }
       }
       
    }
    
    
            <script type="text/javascript">
                $(document).ready(function () {
                    $('#NewsDate').datepicker({ firstDay: 1, dateFormat: 'dd.mm.yy' });
                    $('.datePicker').datepicker({ firstDay: 1, dateFormat: 'dd.mm.yy' });
                    $.datepicker.setDefaults({ dayNamesMin: ['Вс', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб'] });
                    $.datepicker.setDefaults({ monthNames: ['Январь', 'Февраль', 'Март', 'Апрель', 'Май', 'Июнь', 'Июль', 'Август', 'Сентябрь', 'Октябрь', 'Ноябрь', 'Декабрь'] });
                });
            </script> 
            
            
            <script>

                $(document).ready(function () {
                    $("#Header1").addClass("form-control");
                    $("#Header2").addClass("form-control");
                    $("#ImgPath").addClass("form-control");
                    $("#NewsDate").addClass("form-control");
                    $("#NewsPreview").addClass("form-control");
                    $("#NewsText").addClass("form-control");

                });
            </script>   
            
            
@*   <p>Главный заголовок: @Html.EditorFor(x => x.Header1) @Html.ValidationMessageFor(x => x.Header1)</p>
        <p>Подзаголовок: @Html.EditorFor(x => x.Header2) @Html.ValidationMessageFor(x => x.Header2)</p>
        <p>Путь к изображению: @Html.EditorFor(x => x.ImgPath) @Html.ValidationMessageFor(x => x.ImgPath)</p>
        <p>Дата новости: @Html.EditorFor(x => x.NewsDate) @Html.ValidationMessageFor(x => x.NewsDate)</p>        
        <p>Анонс: @Html.TextAreaFor(x => x.NewsPreview) @Html.ValidationMessageFor(x => x.NewsPreview)</p>
        <p>Текст: @Html.TextAreaFor(x => x.NewsText) @Html.ValidationMessageFor(x => x.NewsText)</p>
    *@
    
@*
 @if (Model == null)
    {
    }
    else
    {
        using (Html.BeginForm("UploadNewsImage", "Admin", FormMethod.Post, new { enctype = "multipart/form-data" }))
        {

             @Html.Hidden("newsId", Model.NewsID)


             <table>
                 <tr>
                     <td>
                         @{
            string filename = string.Empty;

            if ((string.IsNullOrWhiteSpace(Model.ImgPath)) || (System.IO.File.Exists(System.IO.Path.Combine(Server.MapPath
                                                                                                                (@Url.Content("~/Content")), Domain.Constants.NEWS_MINI_IMAGES_FOLDER, @Model.NewsID.ToString() + @Model.ImgPath)) != true))
            {
                filename = "0.jpg";
            }
            else
            {
                filename = string.Format("{0}{1}?{2}", Model.NewsID, Model.ImgPath.TrimEnd(), DateTime.Now);
            }
                         }
                         <img class="example-image-link" src='@(Url.Content("~/Content"))/@(Domain.Constants.NEWS_MINI_IMAGES_FOLDER)/@(filename)' alt='@Model.NewsDate' /> 
                     </td>
                     <td style="padding-left: 20px">
                         <input type="file" name="imagefile" />
                         <br />
                         <input type="submit" value="Загрузить" />
                     </td>
                 </tr>
             </table>
        }
    }
*@