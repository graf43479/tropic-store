@model WebUI.Models.ProductsListViewModel
  @{
    ViewBag.Title = Model.Products.First(x=>x.CategoryName!=null).CategoryName;
  }

    @{
        if (Model.CurrentCategory == null)
        {
            ViewBag.Title = "Каталог товаров";
        }   
    }
<div id="ProductContent">
    <div id="BannerContent0">
        <noscript>
            @Html.Partial("_Banner")
        </noscript>
    
        @*     @{
             Html.RenderAction("BannerPreLoad", "Account");
         }   *@
    </div>
<div>
    <div id="crumbs" class="row">
        <ul class="exbreadcrumb">
            @{
                if (Model.CurrentCategory==null)
                {
                    <li class="active"><a href="@Url.Action("List")"  rel="follow, index">Главная</a> </li>
                }
                else
                {
                    <li><a href="@Url.Action("List")"  rel="follow, index">Главная</a></li>
                    <li class="active"><a href="@Url.Action("List", new { category = @Model.Products.First().Category.ShortName })" rel="follow, index">@Model.Products.First().Category.Name</a></li>
                }
            }
        </ul>
    </div>
    <div class="heading">
        <h1>Каталог товаров</h1>
    </div>
    @{
        if (Model.Description!=null)
        {
            <div class="snippet">@Model.Description</div>
        }
        else
        {
            <div class="snippet">Здесь будет описание</div>
        }
    }
    @{
        Html.RenderPartial("SearchOptions");
    }
    <div id="productList">
        <div class="product-grid">
            @foreach (var p in Model.Products)
            {
                Html.RenderPartial("ProductSummary", p);
            }
        </div>
        <div class="pager col-md-12 col-lg-12 col-xs-12">
            @Html.Partial("_ProductListPagination")         
        </div>
    </div>
</div>
    </div>



@*<script src="@Url.Content("~/Scripts/js/grid-listTMP.js")" type="text/javascript"></script>   *@
<script>
    var title = '@ViewBag.Title';
    document.title = title;
</script> 

<script type="text/javascript">
    window.addEventListener('popstate', function (event) {
        console.log("Page state data:", event.state);
    }, false);
    var s = $("ul.exbreadcrumb li.active a").attr('href');
    //alert(browser.name);
    if ($.browser.msie != true) {
        history.pushState(5, "Title 5", s);
    } 
  
</script>


<script>
    $(document).ready(function() {
        object = {
            func: function () { quickviewResizer(); }
        }
        setTimeout(object.func, 300);
        setTimeout(object.func, 1300);
    });
</script>



<script type="text/javascript">
    if (view == 'list') {
        display(view);
    }
    
</script>     

<script>
    $(document).ready(function () {
        var url = "@(Html.Raw(Url.Action("BannerPreload","Account")))";
                $("#BannerContent0").load(url);
                $.ajaxSetup({ cache: false });  //Turn off caching
            });
               </script>

