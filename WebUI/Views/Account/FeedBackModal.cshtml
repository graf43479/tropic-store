@{
    Layout = null;
}

@model Domain.Entities.FeedBack



@{
    if (Session["attempt"] == null)
    {
        Session["attempt"] = 0;
    @*    TempData["attempt"] = TempData.Peek("attempt");*@
    }
    else
    {
        @*TempData["attempt"] = TempData.Peek("attempt");*@
    }
}
<div class="modal" id="stack1" tabindex="-1" data-focus-on="input:first">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
               <div class="heading" style="margin-top: 20px; margin-bottom: 0;">
                   <h2 id="myModalLabel">Обратная связь</h2>
                    <div id="loadingElement" style="display: none"><i class="fa fa-spinner fa-spin" ></i></div>
                    </div>
            </div>
            <div class="modal-body container-fluid">
                @*  @using (Html.BeginForm("AjaxUserEnter", "Account", FormMethod.Post, new
                    {
                        @class = "form-horizontal",
                        Id = "updateLoginForm"
                    }))*@
                    
                    
                @using (Ajax.BeginForm("FeedBackModal", "Account", null, new AjaxOptions
                    {
                        UpdateTargetId = "update-message",
                        InsertionMode = InsertionMode.Replace,
                        HttpMethod = "POST",
                        OnBegin = "gifLoaderBefore",
                        OnFailure = "gifLoaderAfter",
                        OnComplete = "gifLoaderAfter",
                        OnSuccess = "updateSuccessFeedBack"
                    }, new {@id="FeedBackForm"}))    
                {
    
                    @Html.ValidationSummary(true)
                    <div class="col-md-12">
                        <fieldset>
                            <div id="update-message" class="error invisible"></div>
                            <div class="form-group has-feedback">
                                <label class="control-label" for="Name">Ваше имя:</label> 
                                <div class="">
                                    @Html.TextBoxFor(x => x.Name, new { @class = "form-control" }) 
                                    <span class="glyphicon glyphicon-pencil form-control-feedback"></span>
                                    @Html.ValidationMessageFor(x => x.Name)
                                </div>
                            </div>
                
                            <div class="form-group has-feedback">
                                <label class="control-label" for="FeedBackEmail">Email:</label> 
                                <div class="">
                                    @Html.TextBoxFor(x => x.FeedBackEmail, new { @class = "form-control" }) 
                                      <span class="glyphicon glyphicon-pencil form-control-feedback"></span>
                                    @Html.ValidationMessageFor(x => x.FeedBackEmail)
                                </div>
                            </div>
                
                            <div class="form-group ">
                                <label class="control-label" for="FeedBackEmail">Вопрос:</label> 
                                <div class="controls">
                                    @Html.TextAreaFor(x => x.Question, new { @class = "form-control", @style = "min-height: 120px;"}) 
                                    @Html.ValidationMessageFor(x => x.Question)
                                </div>
                            </div>
                        </fieldset>    
                    </div>
                }
            </div>
    
            <div class="modal-footer">
              
                <button class="btn btn-custom" data-dismiss="modal" id="closeButton" aria-hidden="true">Закрыть</button>
                <button class="btn btn-custom" id="FeedBackButton">Отправить</button>    
            </div>
        </div>
    </div>
</div>



<script type="text/javascript">


    $('#FeedBackForm').on('shown', function () {
        $("#contact-add-popup").removeData("validator");
        $("#contact-add-popup").removeData("unobtrusiveValidation");
        $.validator.unobtrusive.parse("#updateAccountEditForm");
    });

    $('#FeedBackButton').click(function (e) {
        e.preventDefault();

        $.validator.unobtrusive.parse($("#FeedBackForm"));

        if ($('#FeedBackForm').valid()) {
            //alert('AJAX');
        }
    }); 

</script>